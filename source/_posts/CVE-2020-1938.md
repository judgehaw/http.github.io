---
title: CVE-2020-1938
copyright: true
date: 2020-05-12 11:27:37
tags: "漏洞"
categories: "漏洞"
---

转自绿盟科技博客：http://blog.nsfocus.net/cve-2020-1938



# 【威胁通告】Apache Tomcat 文件包含漏洞（CVE-2020-1938）

2月20日，国家信息安全漏洞共享平台（CNVD）发布了Apache Tomcat文件包含漏洞（CNVD-2020-10487/CVE-2020-1938）。该漏洞是由于Tomcat AJP协议存在缺陷而导致，攻击者利用该漏洞可通过构造特定参数，读取服务器webapp下的任意文件。若目标服务器同时存在文件上传功能，攻击者可进一步实现远程代码执行。目前，厂商已发布新版本完成漏洞修复。

## 一.  漏洞概述

2月20日，国家信息安全漏洞共享平台（CNVD）发布了Apache Tomcat文件包含漏洞（CNVD-2020-10487/CVE-2020-1938）。该漏洞是由于Tomcat AJP协议存在缺陷而导致，攻击者利用该漏洞可通过构造特定参数，读取服务器webapp下的任意文件。若目标服务器同时存在文件上传功能，攻击者可进一步实现远程代码执行。目前，厂商已发布新版本完成漏洞修复。

Tomcat是Apache软件基金会中的一个重要项目，性能稳定且免费，是目前较为流行的Web应用服务器。由于Tomcat应用范围较广，因此本次通告的漏洞影响范围较大，请相关用户及时采取防护措施修复此漏洞。

参考链接：

https://www.cnvd.org.cn/webinfo/show/5415

## 二、影响范围

**受影响版本**

- Apache Tomcat 6
- Apache Tomcat 7 < 7.0.100
- Apache Tomcat 8 < 8.5.51
- Apache Tomcat 9 < 9.0.31

**不受影响版本**

- Apache Tomcat = 7.0.100
- Apache Tomcat = 8.5.51
- Apache Tomcat = 9.0.31

## 三、漏洞检测

### 3.1版本检测

通常在Apache Tomcat官网下载的安装包名称中会包含有当前Tomcat的版本号，用户可通过查看解压后的文件夹名称来确定当前的版本。

![](http://blog.nsfocus.net/wp-content/uploads/2020/02/image-2.png)

如果解压后的Tomcat目录名称被修改过，或者通过Windows Service Installer方式安装，可使用软件自带的version模块来获取当前的版本。进入Tomcat安装目录的bin目录，输入命令version.bat后，可查看当前的软件版本号。

![](http://blog.nsfocus.net/wp-content/uploads/2020/02/image-3.png)

若当前版本在受影响范围内，则可能存在安全风险。

## 四、漏洞防护

### 4.1官方升级

目前官方已在最新版本中修复了该漏洞，请受影响的用户尽快升级版本进行防护，官方下载链接：

| 版本号                | 下载地址                                 |
| --------------------- | ---------------------------------------- |
| Apache Tomcat 7.0.100 | http://tomcat.apache.org/download-70.cgi |
| Apache Tomcat 8.5.51  | http://tomcat.apache.org/download-80.cgi |
| Apache Tomcat 9.0.31  | http://tomcat.apache.org/download-90.cgi |

4.2其他防护措施

如果相关用户暂时无法进行版本升级，可根据自身情况采用下列防护措施。

一:若不需要使用Tomcat AJP协议，可直接关闭AJP Connector，或将其监听地址改为仅监听本机localhost。

具体操作：

（1）编辑 <CATALINA_BASE>/conf/server.xml，找到如下行（<CATALINA_BASE> 为 Tomcat 的工作目录）：

```
<Connector port="8009"protocol="AJP/1.3" redirectPort="8443" />
```

![](http://blog.nsfocus.net/wp-content/uploads/2020/02/image-4.png)

（2）将此行注释掉（也可删掉该行）：

```
<!--<Connectorport="8009" protocol="AJP/1.3"redirectPort="8443" />-->
```

（3）保存后需重新启动Tomcat，规则方可生效。

二：若需使用Tomcat AJP协议，可根据使用版本配置协议属性设置认证凭证。

使用Tomcat 7和Tomcat 9的用户可为AJP Connector配置secret来设置AJP协议的认证凭证。例如（注意必须将YOUR_TOMCAT_AJP_SECRET更改为一个安全性高、无法被轻易猜解的值）：

```
<Connector port="8009"protocol="AJP/1.3" redirectPort="8443"address="YOUR_TOMCAT_IP_ADDRESS" secret="YOUR_TOMCAT_AJP_SECRET"/>
```

使用Tomcat 8的用户可为AJP Connector配置requiredSecret来设置AJP协议的认证凭证。例如（注意必须将YOUR_TOMCAT_AJP_SECRET更改为一个安全性高、无法被轻易猜解的值）：

```
<Connector port="8009"protocol="AJP/1.3" redirectPort="8443"address="YOUR_TOMCAT_IP_ADDRESS"requiredSecret="YOUR_TOMCAT_AJP_SECRET" />
```

